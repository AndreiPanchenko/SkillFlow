<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="${course.id != null} ? 'Редактирование курса - SkillFlow' : 'Добавление курса - SkillFlow'">SkillFlow</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark navbar-purple">
  <div class="container">
    <a class="navbar-brand" href="/">
      <i class="fas fa-graduation-cap me-2"></i>SkillFlow
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="/experts">
            <i class="fas fa-users me-1"></i>Эксперты
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/students">
            <i class="fas fa-user-graduate me-1"></i>Студенты
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="/courses">
            <i class="fas fa-book me-1"></i>Курсы
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <!-- Заголовок -->
      <div class="d-flex align-items-center mb-4">
        <div class="me-3">
          <i class="fas fa-book fa-2x gradient-text"></i>
        </div>
        <div>
          <h1 class="mb-1" th:text="${course.id != null} ? 'Редактирование курса' : 'Создание курса'"></h1>
          <p class="text-muted mb-0" th:text="${course.id != null} ?
                            'Обновление информации о курсе' :
                            'Заполните информацию о новом курсе'"></p>
        </div>
      </div>

      <!-- Форма -->
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="fas fa-edit me-2"></i>
            <span th:text="${course.id != null} ? 'Редактировать курс' : 'Основная информация'"></span>
          </h5>
        </div>
        <div class="card-body">
          <form th:action="@{/courses}" th:object="${course}" method="post" class="needs-validation" novalidate>
            <input type="hidden" name="expertId" id="expertId" th:value="${course.expert?.id}">

            <!-- Название курса -->
            <div class="mb-3">
              <label for="title" class="form-label">
                <i class="fas fa-heading me-1 text-purple"></i>Название курса
              </label>
              <input type="text" class="form-control" id="title" th:field="*{title}"
                     placeholder="Введите название курса" required>
              <div class="invalid-feedback">
                Пожалуйста, введите название курса.
              </div>
              <div th:if="${#fields.hasErrors('title')}" class="text-danger mt-1">
                <small th:errors="*{title}"></small>
              </div>
            </div>

            <!-- Описание -->
            <div class="mb-3">
              <label for="description" class="form-label">
                <i class="fas fa-align-left me-1 text-purple"></i>Описание курса
              </label>
              <textarea class="form-control" id="description" th:field="*{description}"
                        rows="4" placeholder="Опишите содержание курса, цели обучения и целевую аудиторию..."></textarea>
              <div class="form-text">
                Подробное описание поможет студентам лучше понять содержание курса.
              </div>
            </div>

            <!-- Эксперт -->
            <div class="mb-4">
              <label for="expertSelect" class="form-label">
                <i class="fas fa-user-tie me-1 text-purple"></i>Преподаватель курса
              </label>
              <select class="form-select" id="expertSelect" name="expertId" required>
                <option value="">Выберите преподавателя</option>
                <option th:each="expert : ${experts}"
                        th:value="${expert.id}"
                        th:text="${expert.firstName + ' ' + expert.lastName + ' - ' + expert.specialization}"
                        th:selected="${course.expert != null && course.expert.id == expert.id}">
                </option>
              </select>
              <div class="invalid-feedback">
                Пожалуйста, выберите преподавателя для курса.
              </div>
            </div>

            <!-- Дополнительная информация -->
            <div class="mb-4" th:if="${course.id != null}">
              <label class="form-label">
                <i class="fas fa-info-circle me-1 text-purple"></i>Дополнительная информация
              </label>
              <div class="card bg-light">
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-6">
                      <small class="text-muted">Дата создания:</small>
                      <p class="mb-0 fw-bold" th:text="${#temporals.format(course.creationDate, 'dd.MM.yyyy HH:mm')}"></p>
                    </div>
                    <div class="col-md-6">
                      <small class="text-muted">ID курса:</small>
                      <p class="mb-0 fw-bold text-purple" th:text="${course.id}"></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Кнопки -->
            <div class="d-flex gap-2">
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-save me-2"></i>
                <span th:text="${course.id != null} ? 'Обновить курс' : 'Создать курс'"></span>
              </button>
              <a th:href="@{/courses}" class="btn btn-secondary">
                <i class="fas fa-arrow-left me-2"></i>Назад к списку
              </a>
              <div class="ms-auto">
                <button type="reset" class="btn btn-outline-secondary">
                  <i class="fas fa-undo me-2"></i>Очистить
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <!-- Подсказки -->
      <div class="card mt-4 bg-purple-light">
        <div class="card-body">
          <h6 class="card-title text-purple">
            <i class="fas fa-lightbulb me-2"></i>Рекомендации по созданию курса
          </h6>
          <ul class="list-unstyled mb-0">
            <li><small class="text-muted"><i class="fas fa-check-circle me-2 text-success"></i>Выбирайте понятное и привлекательное название</small></li>
            <li><small class="text-muted"><i class="fas fa-check-circle me-2 text-success"></i>Подробно опишите содержание и цели курса</small></li>
            <li><small class="text-muted"><i class="fas fa-check-circle me-2 text-success"></i>Выбирайте эксперта с соответствующей специализацией</small></li>
            <li><small class="text-muted"><i class="fas fa-check-circle me-2 text-success"></i>Укажите целевую аудиторию и требования к студентам</small></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Футер -->
<footer class="mt-5">
  <div class="container text-center">
    <p class="mb-0">&copy; 2024 SkillFlow. Все права защищены.</p>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Валидация формы
  (function () {
      'use strict'
      var forms = document.querySelectorAll('.needs-validation')
      Array.prototype.slice.call(forms)
          .forEach(function (form) {
              form.addEventListener('submit', function (event) {
                  if (!form.checkValidity()) {
                      event.preventDefault()
                      event.stopPropagation()
                  }
                  form.classList.add('was-validated')
              }, false)
          })
  })()
</script>
</body>
</html>